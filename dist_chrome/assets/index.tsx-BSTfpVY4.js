import{c as j,j as v}from"./client-DtcM3YKn.js";import{p as z}from"./geminiProcess-D6tGS-I9.js";let R=null;console.log("âœ… Content script running on",window.location.href);function l(e,o=5e3){return new Promise(t=>{const r=Date.now();function c(){const i=document.querySelector(e);if(i)return t(i);if(Date.now()-r>o)return t(null);requestAnimationFrame(c)}c()})}async function T(){var r,c,i,s,d,u,m,p,f,w,C,y,g,h,x,S,b,P,q,D,_;const e=window.location.hostname;let o="",t="";if(e.includes("amazon"))console.log("using amazon scraper"),o=((c=(r=document.getElementById("productTitle"))==null?void 0:r.textContent)==null?void 0:c.trim())||"",t=((s=(i=document.querySelector(".a-price .a-offscreen"))==null?void 0:i.textContent)==null?void 0:s.trim())||((u=(d=document.getElementById("priceblock_ourprice"))==null?void 0:d.textContent)==null?void 0:u.trim())||((p=(m=document.getElementById("priceblock_dealprice"))==null?void 0:m.textContent)==null?void 0:p.trim())||"";else if(e.includes("shopee")){console.log("using shopee scraper");const n=await l("h1.vR6K3w"),a=await l("div.IZPeQz.B67UQ0");o=((f=n==null?void 0:n.textContent)==null?void 0:f.trim())||"",t=((w=a==null?void 0:a.textContent)==null?void 0:w.trim())||""}else if(e.includes("lazada")){if(console.log("using lazada scraper"),o=((y=(C=document.querySelector(".pdp-mod-product-badge-title"))==null?void 0:C.textContent)==null?void 0:y.trim())||((h=(g=document.querySelector(".pdp-mod-product-badge-title-v2"))==null?void 0:g.textContent)==null?void 0:h.trim())||"",t=((S=(x=document.querySelector(".pdp-v2-product-price-content-salePrice-amount"))==null?void 0:x.textContent)==null?void 0:S.trim())||"",!t){const n=await l("span[data-spm-anchor-id]");t=((b=n==null?void 0:n.textContent)==null?void 0:b.trim())||""}t=t&&"$"+t}else o=((q=(P=document.querySelector("h1"))==null?void 0:P.textContent)==null?void 0:q.trim())||"",t=((_=(D=document.querySelector("[class*=price]"))==null?void 0:D.textContent)==null?void 0:_.trim())||"";return{title:o||"No product title found",price:t||"No price found"}}const E=document.createElement("div");E.id="__root";document.body.appendChild(E);const I=document.querySelector("#__root");if(!I)throw new Error("Can't find Content root element");const k=j.createRoot(I);k.render(v.jsxs("div",{className:"absolute bottom-0 left-0 text-lg text-black bg-amber-400 z-50",children:["content script ",v.jsx("span",{className:"your-class",children:"loaded"})]}));try{console.log("content script loaded")}catch(e){console.error(e)}async function U(){const e=await T();console.log(e),z(e.title),console.log(z(e.title)),R={...e},chrome.runtime.sendMessage({type:"PRODUCT_DATA",payload:e})}let A=window.location.href;setInterval(()=>{window.location.href!==A&&(A=window.location.href,U())},1e3);U();chrome.runtime.onMessage.addListener((e,o,t)=>{if(e.type==="SCRAPE_PRODUCT")return T().then(r=>{t({success:!0,data:r})}),!0;if(e.type==="PRODUCT_DATA")return t(R),!0});
//# sourceMappingURL=index.tsx-BSTfpVY4.js.map
